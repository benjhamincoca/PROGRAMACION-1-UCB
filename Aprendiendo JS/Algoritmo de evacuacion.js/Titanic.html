<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simulación de Evacuación — Titanic</title>
  <style>
    /* Fuentes y paleta inspirada en Titanic: marino, dorado, blanco antiguo */
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Source+Sans+3:wght@300;400;600&display=swap');

    :root{
      --navy: #0b2545;
      --sea: #0e3b5a;
      --gold: #d4af37;
      --ivory: #fff8ef;
      --muted: #9fb1c7;
      --glass: rgba(255,255,255,0.06);
    }

    html,body{height:100%;margin:0;font-family: 'Source Sans 3', system-ui, -apple-system, 'Segoe UI', Roboto, "Helvetica Neue", Arial; background: linear-gradient(180deg,var(--navy), #071726 60% , #03151f 100%); color:var(--ivory);} 

    .container{max-width:1100px;margin:32px auto;padding:28px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow: 0 10px 30px rgba(2,10,20,0.7);border:1px solid rgba(255,255,255,0.03);}

    header{display:flex;align-items:center;gap:18px}
    .logo{width:86px;height:86px;border-radius:8px;background:linear-gradient(160deg,var(--gold), #c79b2a);display:flex;align-items:center;justify-content:center;font-family:'Playfair Display',serif;color:var(--navy);font-weight:700;font-size:28px;box-shadow:0 6px 18px rgba(0,0,0,0.5)}
    h1{margin:0;font-family:'Playfair Display',serif;font-size:28px;color:var(--ivory)}
    p.lead{margin:4px 0 0;color:var(--muted)}

    .grid{display:grid;grid-template-columns:1fr 420px;gap:20px;margin-top:22px}

    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:16px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);}

    /* Pasajeros */
    .pasajeros-list{max-height:360px;overflow:auto;padding:8px;display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .pasajero{background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.02);display:flex;align-items:center;gap:10px}
    .avatar{width:44px;height:44px;border-radius:8px;background:var(--glass);display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--ivory);font-family:'Playfair Display'}
    .meta{font-size:13px;color:var(--ivory)}
    .meta small{color:var(--muted);display:block}

    /* Botes */
    .botes{display:flex;flex-direction:column;gap:12px}
    .bote{display:flex;align-items:center;gap:12px;padding:10px;border-radius:10px;border:1px dashed rgba(255,255,255,0.04);background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.015));}
    .bote .info{flex:1}
    .bote .bar{height:12px;border-radius:8px;background:rgba(255,255,255,0.03);overflow:hidden}
    .bote .fill{height:100%;background:linear-gradient(90deg,var(--gold), #f2d77b);width:20%}

    /* Controles */
    .controls{display:flex;gap:8px;margin-top:12px}
    button{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px 12px;border-radius:8px;color:var(--ivory);cursor:pointer;font-weight:600}
    button.primary{background:linear-gradient(90deg,var(--gold), #f1d175);color:var(--navy);border:none}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}

    /* Resultado */
    .resultados{margin-top:12px}
    .res-list{max-height:220px;overflow:auto;padding:8px}
    .left-out{color:#ffb3b3}

    footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}

    /* Responsivo */
    @media (max-width:980px){.grid{grid-template-columns:1fr;}.logo{display:none}}

  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">TI</div>
      <div>
        <h1>Simulación de Evacuación — Titanic</h1>
        <p class="lead">Ordena y embarca pasajeros en botes de rescate usando clases en JavaScript — inspirado en la estética del Titanic.</p>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <h3>Pasajeros</h3>
        <div class="pasajeros-list" id="listaPasajeros"></div>

        <div class="controls">
          <button id="btnRandom">Generar ejemplo</button>
          <button id="btnReset">Reiniciar</button>
          <button class="primary" id="btnEvacuar">Ejecutar evacuación</button>
        </div>

        <div class="resultados card" style="margin-top:12px;background:transparent;border:none;padding:0">
          <h4>Pasajeros que quedaron fuera</h4>
          <div class="res-list" id="quedaronFuera"></div>
        </div>
      </section>

      <aside class="card">
        <h3>Botes de Rescate</h3>
        <div class="botes" id="botesContainer"></div>
        <div style="margin-top:12px">
          <label style="font-size:13px;color:var(--muted)">Agregar bote:</label>
          <div style="display:flex;gap:8px;margin-top:6px">
            <input id="capInput" type="number" min="1" value="4" style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--ivory)"/>
            <button id="addBoatBtn">Añadir</button>
          </div>
        </div>
      </aside>
    </div>

    <footer>
      Código didáctico — clases: <strong>Pasajero</strong> y <strong>BoteRescate</strong> • Prioridad: mujeres → menores → clase de boleto
    </footer>
  </div>

  <script>
    /* ======= CLASES (JS) ======= */
    class Pasajero {
      constructor(nombre, edad, genero, tipo_boleto) {
        this.nombre = nombre;
        this.edad = edad;
        this.genero = genero; // "Masculino" | "Femenino"
        this.tipo_boleto = tipo_boleto; // "1ra Clase" | "2da Clase" | "3ra Clase"
      }
      mostrarInfo(){
        return `${this.nombre} — ${this.edad} años — ${this.genero} — ${this.tipo_boleto}`;
      }
      toString(){ return this.mostrarInfo(); }
    }

    class BoteRescate {
      constructor(capacidad = 4, lista_pasajeros = []) {
        this.maximo_pasajeros = capacidad;
        this.lista_pasajeros = lista_pasajeros;
      }
      agregarPasajero(pas){
        if (this.lista_pasajeros.length < this.maximo_pasajeros) {
          this.lista_pasajeros.push(pas);
          return true;
        }
        return false;
      }
      mostrarPasajeros(){
        return this.lista_pasajeros.map(p=>p.toString()).join('\n');
      }
      ocupacion(){ return this.lista_pasajeros.length; }
    }

    /* ======= Datos y UI ======= */
    const listaPasajerosEl = document.getElementById('listaPasajeros');
    const botesContainer = document.getElementById('botesContainer');
    const quedaronFueraEl = document.getElementById('quedaronFuera');

    let pasajeros = [];
    let botes = [];

    function crearEjemplo(){
      pasajeros = [
        new Pasajero('Ana Bennet', 25, 'Femenino', '1ra Clase'),
        new Pasajero('Luis Carter', 30, 'Masculino', '2da Clase'),
        new Pasajero('María O\'Neill', 17, 'Femenino', '3ra Clase'),
        new Pasajero('Pedro Williams', 40, 'Masculino', '1ra Clase'),
        new Pasajero('Lucía Smith', 35, 'Femenino', '2da Clase'),
        new Pasajero('Carlos Brown', 12, 'Masculino', '3ra Clase'),
        new Pasajero('Elena Johnson', 50, 'Femenino', '1ra Clase'),
        new Pasajero('Jorge Davies', 28, 'Masculino', '3ra Clase'),
        new Pasajero('Sofía Thompson', 5, 'Femenino', '2da Clase'),
        new Pasajero('Andrés Miller', 60, 'Masculino', '1ra Clase'),
        new Pasajero('Margaret Shaw', 33, 'Femenino', '2da Clase'),
        new Pasajero('Thomas King', 22, 'Masculino', '3ra Clase')
      ];

      botes = [ new BoteRescate(3), new BoteRescate(4), new BoteRescate(3) ];
      renderAll();
    }

    function renderPassengers(){
      listaPasajerosEl.innerHTML = '';
      pasajeros.forEach((p, idx) => {
        const div = document.createElement('div'); div.className='pasajero';
        const avatar = document.createElement('div'); avatar.className='avatar'; avatar.textContent = p.nombre.split(' ')[0].slice(0,2).toUpperCase();
        const meta = document.createElement('div'); meta.className='meta'; meta.innerHTML = `<strong>${p.nombre}</strong><small>${p.genero} • ${p.edad} años • ${p.tipo_boleto}</small>`;
        div.appendChild(avatar); div.appendChild(meta);
        listaPasajerosEl.appendChild(div);
      });
    }

    function renderBoats(){
      botesContainer.innerHTML = '';
      botes.forEach((bote, i)=>{
        const el = document.createElement('div'); el.className='bote';
        const info = document.createElement('div'); info.className='info';
        info.innerHTML = `<strong>Bote ${i+1}</strong> <div style="font-size:13px;color:var(--muted)">Capacidad: ${bote.maximo_pasajeros} — Ocupados: ${bote.ocupacion()}</div>`;
        const barWrap = document.createElement('div'); barWrap.style.width='170px';
        const bar = document.createElement('div'); bar.className='bar';
        const fill = document.createElement('div'); fill.className='fill';
        const percent = Math.min(100, Math.round((bote.ocupacion()/bote.maximo_pasajeros)*100));
        fill.style.width = percent + '%';
        bar.appendChild(fill); barWrap.appendChild(bar);

        el.appendChild(info);
        el.appendChild(barWrap);
        botesContainer.appendChild(el);
      });
    }

    function renderLeftOut(list){
      quedaronFueraEl.innerHTML = '';
      if(list.length===0){ quedaronFueraEl.textContent = 'Ninguno — todos fueron rescatados.'; return }
      list.forEach(p=>{
        const d = document.createElement('div'); d.style.padding='6px 0'; d.textContent = p.toString(); d.className='left-out';
        quedaronFueraEl.appendChild(d);
      })
    }

    function renderAll(){ renderPassengers(); renderBoats(); renderLeftOut([]); }

    /* ======= Algoritmo de evacuación ======= */
    function criterioPrioridad(a,b){
      // 1) genero: mujeres primero
      if(a.genero !== b.genero){ if(a.genero === 'Femenino') return -1; if(b.genero === 'Femenino') return 1; }
      // 2) menores de 18
      const aMinor = a.edad < 18; const bMinor = b.edad < 18;
      if(aMinor !== bMinor) return aMinor ? -1 : 1;
      // 3) clase de boleto: 1ra > 2da > 3ra
      const map = {'1ra Clase':1,'2da Clase':2,'3ra Clase':3};
      return map[a.tipo_boleto] - map[b.tipo_boleto];
    }

    function evacuar(){
      // clonar arrays para no mutar origen
      const lista = pasajeros.slice().sort(criterioPrioridad);
      // vaciar ocupantes actuales de botes
      botes.forEach(b => b.lista_pasajeros = []);

      const noSubieron = [];
      for(const p of lista){
        let subio = false;
        for(const b of botes){
          if(b.agregarPasajero(p)){ subio = true; break }
        }
        if(!subio) noSubieron.push(p);
      }

      renderBoats(); renderLeftOut(noSubieron);
    }

    /* ======= Eventos UI ======= */
    document.getElementById('btnRandom').addEventListener('click', crearEjemplo);
    document.getElementById('btnReset').addEventListener('click', ()=>{ pasajeros=[]; botes=[]; renderAll(); });
    document.getElementById('btnEvacuar').addEventListener('click', evacuar);

    document.getElementById('addBoatBtn').addEventListener('click', ()=>{
      const cap = parseInt(document.getElementById('capInput').value) || 4;
      botes.push(new BoteRescate(cap)); renderBoats();
    });

    // iniciar con ejemplo
    crearEjemplo();
  </script>
</body>
</html>